{% extends 'base.html' %}
{% load static %}
{% block title %}Astro Share Blog{% endblock %}
{% block meta %}
<meta name="description"
  content="Frontpage blogpost">
{% endblock %}
{% block content %}

{% with image_url='/images/background.webp' %}
<div class="container-sub wapper"
  style="background: url('{% static image_url %}') no-repeat fixed top right / cover;">
  <div class="container-sub">
    <h1 style="color: var(--main-text-color);">Latest Posts</h1>
  </div>
  {% for post in posts %}
  <section class="row post {% if forloop.counter0|divisibleby:2 %} bg-l-gray {% else %} bg-d-gray {% endif %}">
    <div
      class="col-12 d-flex flex-wrap align-items-start container-banner {% if forloop.counter0|divisibleby:2 %} flex-row-reverse {% endif %}">

      <!-- Image Column -->
      <div class="col-12 col-sm-6 col-md-4 order-2 order-sm-1">
        {% if post.image.url %}
        <img src="{{ post.image.url }}" class="img-thumbnail w-100" alt="Image for {{ post.title }}" loading="lazy">
        {% else %}
        <img src="{% static 'images/no-image-available.jpg' %}" class="img-thumbnail w-100" alt="No image available"
          loading="lazy">
        {% endif %}
      </div>

      <!-- Content Column -->
      <div class="col-sm-6 col-md-8 order-1 order-sm-2">
        <h3 style="padding-left: 0.85rem;">{{ post.title }}</h3>
        <div class="container-sub">
          {{ post.body|slice:":300" }}
          <a href="{% url 'article-detail' post.pk %}" class="color-hyperlink">
            <small><strong>[Read more]</strong></small></a>

            <p class="italicize">Posted: <strong>{{ post.post_date }}</strong> Category:
              <strong>{{ post.category }}</strong>
              By: <strong>{{ post.author.last_name }}</strong>, <strong>{{ post.author.first_name }}</strong>
            </p>
        </div>

        {% if user.is_authenticated and user == post.author %}
        <div class="container-sub">
          <a href="{% url 'update-post' post.pk %}" class="btn btn-warning" >Edit</a>

          <a href="{% url 'delete-post' post.pk %}" class="btn btn-danger">Delete</a>
        </div>
        {% endif %}
      </div>
    </div>
  </section>



  <hr>
  {% endfor %}

  {% include 'pagination.html' %}

  <div class="container-custom">
    <div class="back-to-top-button" style="padding-top: 1rem;">
      <a href="#" class="btn btn-primary color-hyperlink-footer">Back to Top</a>
    </div>
  </div>

</div>
{% endwith %}

{% endblock %}